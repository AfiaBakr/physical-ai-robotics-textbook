# Data Model: Docusaurus embedding Pipeline

## Key Entities

### DocumentChunk
Represents a segment of text extracted from a Docusaurus page, containing the raw text, source URL, and metadata.

**Fields**:
- `id`: str - Unique identifier for the chunk
- `text_content`: str - Cleaned text content extracted from the page
- `source_url`: str - Original URL where the content was found
- `page_title`: str - Title of the source page
- `chunk_index`: int - Position of this chunk within the original document
- `created_at`: datetime - Timestamp when the chunk was created
- `metadata`: dict - Additional metadata (word count, content type, etc.)

**Validation Rules**:
- `text_content` must not be empty
- `source_url` must be a valid URL format
- `chunk_index` must be non-negative

### VectorRepresentation
Mathematical representation of text content generated by an external service, stored with associated document chunk information.

**Fields**:
- `chunk_id`: str - Reference to the source DocumentChunk
- `vector`: list[float] - Numerical vector representation of the text
- `embedding_model`: str - Name/version of the model used
- `embedding_service`: str - Service provider (e.g., "cohere")
- `created_at`: datetime - Timestamp when the vector was generated

**Validation Rules**:
- `vector` must be a non-empty list of floats
- `embedding_model` must be specified
- `chunk_id` must reference an existing DocumentChunk

### IndexEntry
Record in the Qdrant vector database containing the vector representation, document metadata, and identifiers for retrieval.

**Fields**:
- `id`: str - Unique identifier in the vector database
- `payload`: dict - Metadata associated with the vector (source_url, page_title, etc.)
- `vector`: list[float] - The vector representation
- `timestamp`: datetime - When the entry was indexed

**Validation Rules**:
- `id` must be unique within the collection
- `vector` dimensions must match collection schema
- `payload` must contain required metadata fields

## Relationships

```
DocumentChunk (1) → (1) VectorRepresentation (1) → (1) IndexEntry
```

Each DocumentChunk generates exactly one VectorRepresentation, which creates exactly one IndexEntry in the vector database.

## State Transitions

### DocumentChunk Lifecycle
- `NEW` → `EXTRACTED` → `CLEANED` → `CHUNKED` → `PROCESSED`
- Possible error state: `FAILED` (at any stage)

### VectorRepresentation Lifecycle
- `PENDING` → `EMBEDDING` → `GENERATED` → `STORED`
- Possible error state: `FAILED` (at any stage)

## Collection Schema (Qdrant)

### Collection: rag_embeddings
- **Vectors Config**: Size based on embedding model (e.g., 1024 for Cohere multilingual v3)
- **Payload Schema**:
  - `source_url`: keyword (indexed)
  - `page_title`: text (indexed)
  - `chunk_index`: integer
  - `text_content`: text
  - `created_at`: integer (timestamp)
  - `metadata`: nested object